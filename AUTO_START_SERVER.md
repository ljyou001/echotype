# 自动启动服务器功能说明

## 功能概述

EchoType客户端现在支持自动启动本地模型服务器，无需手动管理服务器进程。

## 工作原理

当满足以下条件时，客户端会自动启动服务器：

1. **模型源设置为"本地模型"**
2. **"自动启动服务器"选项已启用**（默认启用）
3. **检测到服务器未运行**

### 自动启动时机

- **客户端启动时**: 如果检测到服务器未运行，会自动启动
- **连接失败时**: 如果连接服务器失败，会尝试自动启动服务器

## 如何使用

### 1. 启用自动启动（默认已启用）

1. 右键点击托盘图标 → 打开设置
2. 在"模型"标签页中选择"本地模型"
3. 确保"自动启动服务器（当服务器未运行时）"选项已勾选
4. 点击"保存"

### 2. 禁用自动启动

如果你想手动管理服务器，可以：

1. 打开设置 → 模型标签页
2. 取消勾选"自动启动服务器（当服务器未运行时）"
3. 点击"保存"

## 服务器管理

即使启用了自动启动，你仍然可以通过服务器管理UI手动控制服务器：

1. 打开设置 → 模型标签页
2. 点击"打开服务器管理"按钮
3. 在服务器管理界面中可以：
   - 查看服务器状态
   - 手动启动/停止/重启服务器
   - 查看加载进度和运行日志

## 注意事项

1. **后台运行**: 自动启动的服务器会在后台运行，不会显示窗口
2. **资源占用**: 服务器会占用一定的内存和CPU资源
3. **退出行为**: 关闭客户端时，会自动停止由客户端启动的服务器进程
4. **手动启动**: 如果服务器是手动启动的（不是通过客户端），客户端不会重复启动

## 配置文件

自动启动设置保存在配置文件中：

```json
{
  "model_source": "local",
  "auto_start_server": true
}
```

- `model_source`: 模型源类型（local/custom/builtin）
- `auto_start_server`: 是否自动启动服务器（true/false）

## 故障排除

### 服务器无法自动启动

1. 检查服务器文件是否存在（start_server.py）
2. 查看日志文件了解详细错误信息
3. 尝试手动启动服务器测试是否正常工作

### 服务器重复启动

- 客户端会检测服务器是否已运行，不会重复启动
- 如果出现问题，可以通过服务器管理UI停止所有服务器进程

## 相关功能

- [服务器管理UI](server/README_SERVER_MANAGER.md)
- [配置说明](README.md#配置)
